---
title: "Regression analysis of wine quality based on its physicochemical properties"
subtitle: "based on white Vinho Verde wine from Portugal"
author: "Ziyao Han"
thanks: "Code and data are available at: https://github.com/HanFrank/Analysis-of-Wine-Quality-based-on-its-physicochemical-properties"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "Wine is one of the most widely consumed beverages in the world with significant cultural influence. In this paper, the physicochemical properties of wine will be compared with the perceived quality of wine by wine experts. Even though the preference for wine taste is highly subjective, this study may help identify objective components for wine preference. We found that Alcohol percentage, Sulphate, and less acidic wines yield higher quality scores, while sugar percentage does not appear to affect scores significantly. \\par \\textbf {Keywords:} Multiple Linear Regression, Model Selection, Wine Quality, White Wine, Vinho Verde, Physicochemical Properties"
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(knitr)
library(bookdown)
library(kableExtra)
library(ggplot2)

# Grabbing dataset
white_wine <- read_csv(here::here("inputs/data/cleaned_white_wine.csv"))

# removing id generated by read_csv
white_wine <- white_wine[-c(1)]
```

# Introduction

Wine is one of the most widely consumed beverages in the world with significant cultural influence. Wine is made through an arduous process of selecting fruit, processing, fermentation, and ageing with many small intricacies that impact the final product. The sugar and acid levels of the fruit and ageing vessels are just some of the ways that the taste of the final product can be changed [@citeWine]. Wine has historically been consumed as a part of cultural and religious ceremonies throughout the world and is a part of the cultural identities of many countries, especially in Europe [@citeHistory].

In this report, the dataset that will be used was obtained from UCI's (University of California Irvine) Machine Learning Repository and will be used for statistical modelling and visualization of the data. Some of the physicochemical variables include: Citric acid, residual sugar, chlorides, pH, and alcohol percentage. The wine's quality was graded by various wine experts on a scale of 0 (very bad) to 10 (very excellent) [@citeVinho]. Moreover, this report will use Multiple Linear Regression along with Model selection techniques in order to create an appropriate model for modelling wine quality. Furthermore, this report will interpret the results of the determined model and discuss the possible implications.

The preference for the taste of wine is highly subjective just like with all other foods and drinks. There have been many studying showing that even many experts in blind taste tests cannot accurately differentiate between cheap and expensive wines [@citeTasting]. Thus, the possible implications of the study could show the objective physicochemical properties associated with wine quality. Moreover, a goal of this study is to identify dominant physicochemical variables associated with the taste of wine. The results could provide valuable insight into wine production and consumer preference. 

The layout of this paper will be presented in several sections. Section \@ref(data) will discuss the source of the data and key features along with possible data limitations. Section \@ref(model) will present the selected Linear Regression Model along with an explanation of the variables and properties of the model. Next, Section \@ref(results) will present the results of the study with appropriate visualizations such as tables and graphs. Finally, Section \@ref(discussion) will be a commentary and analysis of the results along with weaknesses and potential next steps. 

# Data {#data}

The data used in this report was obtained through the UCI Machine Learning Repository [@citeUCI] and provided by [@citeVinho]. The statistical analysis in this report will be done using `R` [@citeR]. The R Packages, `tidyverse` [@citetidy] and `dplyr` [@citedplyr] will be used for data manipulation and cleaning. The graphs and tables for this report will created and formatted with `ggplot2` [@citeggplot] and `kableExtra` [@citekable]. The packages `bookdown` [@citebookdown] and `knitr` [@citeknitr] will be used to format this report.

The original dataset contained 4898 observations of different white Vinho Verde wines with 12 variables. These variables are: Fixed acidity, volatile acidity, citric acid, residual sugar, chlorides, free sulfur dioxide, total sulfur dioxide, density, pH, sulphates, alcohol level, and a quality score from 0 to 10. The first 11 variables are physicochemical properties that were measured through scientific tests while the quality score was determined by several experts grading each wine from 0 (very bad) to 10 (very excellent). 

Table 1 is a summary of the variables in our dataset.

```{r, echo = FALSE, warning = FALSE, results = FALSE}
# Making a table with a summary of each variable
# Getting data summaries
summary(white_wine$fixed.acidity)
summary(white_wine$volatile.acidity)
summary(white_wine$citric.acid)
summary(white_wine$residual.sugar)
summary(white_wine$chlorides)
summary(white_wine$free.sulfur.dioxide)
summary(white_wine$total.sulfur.dioxide)
summary(white_wine$density)
summary(white_wine$pH)
summary(white_wine$sulphates)
summary(white_wine$alcohol)
summary(white_wine$quality)
```


## Model selection:

For our analysis, we will be using contextual reasoning combined with Model Diagnostics and the significance of the parameter estimates. Additionally, the Akaike information criterion (AIC) and Bayesian Information Criterion (BIC) will be used to measure how well variables fit the model. We will not be using an automated variable selection procedure because it ignores the contextual reasoning behind the variable selection and may cause bias [@citeBias]. In general, we would be looking for a smaller model so as to not overfit the model and a smaller model allows for better context analysis.

Variables such as volatile acidity, fixed acidity, citric acid, pH all tell a similar story so pH will be used instead of all of these variables. This is also true for free sulphur dioxide, total sulphur dioxide and sulphates. Thus, the sulphates will be used to account for this factor.

## Data Limitations

1. Only white wine

2. Taste is subjective

3. Only 1 type of wine from 1 country

4. Many variables may be correlated (Multicollinearity)

5. Removing variables removes some potential explanatory ability for example citric acid and pH isn't entirely the same thing


# Model {#model}

$$y_i = \beta_0 + \beta_1x_1 + \beta_2x_2 + \beta_3x_3 + \beta_4x_4 + \epsilon$$

where: 

- $y_i$ is the response variable, quality score of the wine
- $\beta_0$ is the estimated intercept coefficient
- $\beta_1x_1$ is the estimated intercept and predictor variable for Alcohol percentage
- $\beta_2x_2$ is the estimated intercept and predictor variable for pH
- $\beta_3x_3$ is the estimated intercept and predictor variable for Sulphates
- $\beta_4x_4$ is the estimated intercept and predictor variable for Residual Sugars
- $\epsilon$ is the error term

```{r, echo = FALSE, warning = FALSE, results = FALSE}
model <- lm(quality ~ alcohol + pH + sulphates + residual.sugar, data = white_wine)
summary(model)
```


# Results {#results}

# Discussion {#discussion}

## First discussion point

## Second discussion point

## Third discussion point

## Weaknesses and next steps

\newpage

\appendix

# Appendix {-}

```{r echo=FALSE}
r <- resid(model)
# residual plots
pairs(white_wine[,9:11], main="Residual plots for variables in model")
```


# Additional details


\newpage


# References


